{"version":3,"sources":["../src/assess-student-table.js"],"names":["ajaxSubtableResponseProcessorData","url","params","response","data","map","rowstring","JSON","parse","init","tabulatorelementid","tableelement","tableUniqueid","rowFormatter","row","holderEl","document","createElement","tableEl","appendChild","id","getData","getElement","style","boxSizing","padding","borderTop","borderBotom","background","setAttribute","border","filters","jointype","appraisalid","name","values","stringify","direction","value","type","toString","pagination","ajaxFiltering","ajaxSorting","paginationDataReceived","layout","ajaxResponse","e","target","className","toggle","selectable","resizableColumns","minHeight"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This is a table with nested tables in rows: http://tabulator.info/examples/4.9#nested-tables\n *\n * @module   local_cltools/assess-student-table.js\n * @copyright 2021 - CALL Learning - Laurent David <laurent@call-learning.fr>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport {tableInit} from \"local_cltools/local/table/dynamic\";\n\n// Same as in the usual dynamic but as we are not paginating, we send the whole data.\nconst ajaxSubtableResponseProcessorData = function (url, params, response) {\n    return response.data.map(\n        (rowstring) => JSON.parse(rowstring)\n    );\n};\n\nexport const init = async (tabulatorelementid) => {\n    const tableelement = $(\"#\" + tabulatorelementid);\n    const tableUniqueid = tableelement.data('tableUniqueid');\n    const rowFormatter = (row) => {\n        const holderEl = document.createElement(\"div\");\n        const tableEl = document.createElement(\"div\");\n        holderEl.appendChild(tableEl);\n        const id = row.getData().id;\n        row.getElement().appendChild(holderEl);\n        holderEl.style.boxSizing = \"border-box\";\n        holderEl.style.padding = \"10px 10px 10px 10px\";\n        holderEl.style.borderTop = \"1px solid #333\";\n        holderEl.style.borderBotom = \"1px solid #333\";\n        holderEl.style.background = \"#ddd\";\n        holderEl.setAttribute('class', \"appraisalSubtable\" + id + \"\");\n\n        tableEl.style.border = \"1px solid #333\";\n        tableEl.setAttribute('class', \"appraisalSubtable\" + id + \"\");\n\n        const filters = {\n            jointype: 2,\n            filters: {\n                appraisalid: {\n                    name: \"appraisalid\", jointype: 2, values:\n                        [JSON.stringify({direction: \"==\", value: id})],\n                    type: \"numeric_comparison_filter\"\n                }\n            }\n        };\n        tableInit(\n            tableEl,\n            'local_cveteval\\\\local\\\\assessment\\\\appraisals_criteria',\n            tableUniqueid + id.toString(),\n            0,\n            filters,\n            () => null,\n            {\n                pagination: false,\n                ajaxFiltering: false,\n                ajaxSorting: false,\n                paginationDataReceived: false,\n                layout:\"fitColumns\",\n                ajaxResponse: ajaxSubtableResponseProcessorData\n            }\n        );\n    };\n    tableInit(\"#\" + tabulatorelementid,\n        tableelement.data('tableHandler'),\n        tableUniqueid,\n        tableelement.data('table-pagesize'),\n        tableelement.data('tableFilters'),\n        (e, row) =>   {\n                const id = row.getData().id;\n                if (e.target.className === \"tabulator-cell\") {\n                    $(\".appraisalSubtable\" + id + \"\").toggle();\n                }\n        },\n        {\n            rowFormatter: rowFormatter,\n            selectable: true,\n            resizableColumns: false,\n            layout: \"fitColumns\",\n            minHeight: \"400px\"\n        }\n    );\n};\n"],"file":"assess-student-table.min.js"}